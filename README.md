# TF-IDF Анализатор текста

Веб-приложение для анализа текстовых файлов с использованием алгоритма TF-IDF (Term Frequency - Inverse Document Frequency).

## Версия
v0.2.0

## Описание проекта

TF-IDF Анализатор - это веб-приложение, которое позволяет выполнять анализ текстовых файлов на русском языке, рассчитывая значения TF (частота термина) и IDF (обратная частота документа) для слов в тексте. Это полезно для определения значимости слов в документе относительно коллекции документов.

Основные возможности:
- Загрузка текстовых файлов через веб-интерфейс
- Автоматическая токенизация и фильтрация русского текста (удаление стоп-слов, пунктуации, цифр)
- Расчет показателей TF для каждого слова в документе
- Расчет показателей IDF относительно всех ранее загруженных документов
- Отображение 50 наиболее значимых слов, отсортированных по убыванию значения IDF

## Технический стек

- **Backend**: FastAPI, Python 3
- **База данных**: SQLite с SQLModel (ORM)
- **Обработка текста**: NLTK, razdel
- **Frontend**: HTML, Bootstrap 5
- **Шаблонизатор**: Jinja2
- **Веб-сервер**: Uvicorn
- **Контейнеризация**: Docker

## Установка и запуск

### Предварительные требования

- Python 3.8 или выше
- pip (менеджер пакетов Python)
- Docker и Docker Compose (для запуска в контейнере)

### Запуск через Docker

1. Клонируйте репозиторий:
```bash
git clone https://github.com/amoglock/intership_lesta.git
cd itership_lesta
```

2. Запустите приложение с помощью Docker Compose:
```bash
docker-compose up -d
```

3. Приложение будет доступно по адресу:
```
http://localhost:8000
```

### Запуск без Docker

1. Клонируйте репозиторий:
```bash
git clone https://github.com/amoglock/intership_lesta.git
cd itership_lesta
```

2. Создайте и активируйте виртуальное окружение (опционально, но рекомендуется):
```bash
python -m venv venv
source venv/bin/activate  # Для Linux/macOS
# или
venv\Scripts\activate     # Для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Запустите сервер:
```bash
uvicorn src.main:app --reload
```

5. Откройте веб-браузер и перейдите по адресу:
```
http://localhost:8000
```

## Конфигурация

Приложение можно настроить через переменные окружения или файл `.env`:

| Параметр | Описание | Значение по умолчанию |
|----------|----------|----------------------|
| `APP_HOST` | Хост для запуска приложения | `0.0.0.0` |
| `APP_PORT` | Порт для запуска приложения | `8000` |
| `DEBUG` | Режим отладки | `False` |
| `DATABASE_URL` | URL подключения к базе данных | `sqlite:///./tf_idf.db` |
| `MAX_FILE_SIZE` | Максимальный размер загружаемого файла (в байтах) | `1048576` (1MB) |
| `ALLOWED_EXTENSIONS` | Разрешенные расширения файлов | `txt` |
| `TOP_WORDS_COUNT` | Количество отображаемых слов | `50` |
| `CORS_ORIGINS` | Разрешённые источники для CORS (JSON или строка через запятую) | `*` |
| `ALLOWED_FILE_TYPES` | Разрешённые типы файлов (JSON или строка через запятую) | `text/plain` |
| `LOG_LEVEL` | Уровень логирования | `INFO` |

## Структура проекта

```
src/
├── core/               # Основные настройки и утилиты
│   ├── config.py       # Конфигурация приложения
│   └── exceptions.py   # Пользовательские исключения
├── tf_idf/             # Модуль обработки TF-IDF
│   ├── processor.py    # Процессор для анализа текста
│   ├── repository.py   # Работа с базой данных
│   ├── router.py       # Маршруты FastAPI
│   └── models.py       # Модели данных для TF-IDF
├── static/             # Статические файлы (CSS, JS)
├── templates/          # Шаблоны HTML
│   └── upload.html     # Шаблон для загрузки и отображения результатов
├── models.py           # Модели данных SQLModel
├── database.py         # Настройка базы данных
└── main.py            # Основной файл приложения
```

## Changelog


### v0.1.0 (Тестовое задание)
- Базовая реализация TF-IDF анализатора
- Простой веб-интерфейс для загрузки файлов
- Базовая обработка русского текста
- Хранение результатов в SQLite

### v0.2.0 (Текущая версия)
- Добавлена поддержка Docker и Docker Compose
- Улучшена обработка ошибок и валидация входных данных
- Добавлена конфигурация через переменные окружения
- Все параметры конфигурации вынесены в .env (порты, БД, CORS, типы файлов, лимиты, логирование)
- Добавлены эндпоинты:
  - `/status` — для проверки статуса приложения (возвращает `{"status": "OK"}`)
  - `/metrics` — возвращает метрики приложения (см. ниже)
  - `/version` — возвращает версию приложения
- Метрики:
  - `total_requests` — общее количество запросов к API (для мониторинга нагрузки)
  - `total_analyses` — общее количество анализов, проведённых через сервис (для оценки востребованности)
- Аргументация метрик:
  - `total_requests` позволяет отслеживать активность и потенциальные DDoS-атаки
  - `total_analyses` показывает реальную пользу и востребованность сервиса

## Как это работает

### TF (Term Frequency)

Частота термина показывает, насколько часто слово встречается в документе. Рассчитывается по формуле:

```
TF(слово) = (Количество вхождений слова в документе) / (Общее количество слов в документе)
```

### IDF (Inverse Document Frequency)

Обратная частота документа показывает, насколько редко слово встречается во всей коллекции документов. Рассчитывается по формуле:

```
IDF(слово) = log((Общее количество документов + 1) / (Количество документов, содержащих слово + 1))
```

Добавление единицы к числителю и знаменателю (сглаживание) помогает избежать деления на ноль и обеспечивает более стабильные результаты.

### Обработка текста

1. Текст токенизируется с помощью библиотеки razdel, специально разработанной для русского языка.
2. Удаляются стоп-слова (частые служебные слова, не несущие смысловой нагрузки).
3. Удаляются знаки пунктуации, цифры и пробельные символы.
4. Для каждого слова рассчитываются значения TF и IDF.
5. Результаты сортируются по убыванию значения IDF и выводятся 50 верхних слов.
